{"nodes":[{"parameters":{"path":"youtube-phase5-montage","responseMode":"lastNode","options":{}},"id":"2415dc07-b580-436c-947b-4cb83c34fbc4","name":"ðŸŽ¯ Trigger Phase 5","type":"n8n-nodes-base.webhook","position":[32,208],"typeVersion":1.1,"webhookId":"phase5-montage-webhook"},{"parameters":{"content":"## Phase 5: Montage VidÃ©o\n\nInputs: script_url, assets_folder_url, project_name\nOutputs: video_url, video_duration, duration_diff","height":150,"width":350,"color":3},"id":"d2232743-3c03-4da7-9acc-5e0161ff2c19","name":"ðŸ“‹ PHASE 5: MONTAGE","type":"n8n-nodes-base.stickyNote","position":[0,0],"typeVersion":1},{"parameters":{"jsCode":"// Simuler le tÃ©lÃ©chargement d'assets\nconst config = $input.first().json.body;\nreturn [{json: {\n  assets: [\n    {path: '/tmp/intro_001.png', duration: 5},\n    {path: '/tmp/section1_001.png', duration: 8},\n    {path: '/tmp/broll_001.mp4', duration: 5}\n  ],\n  project_name: config.project_name\n}}];"},"id":"6a0fd040-9ff6-4114-b1fc-1e5a6f875183","name":"ðŸ“¥ TÃ©lÃ©charger Assets","type":"n8n-nodes-base.code","position":[224,208],"typeVersion":2},{"parameters":{"jsCode":"const assets = $input.first().json.assets;\nconst projectName = $input.first().json.project_name;\n\nconst commands = [\n  'ffmpeg -loop 1 -i /tmp/intro_001.png -t 5 -pix_fmt yuv420p /tmp/clip1.mp4',\n  'ffmpeg -loop 1 -i /tmp/section1_001.png -t 8 -pix_fmt yuv420p /tmp/clip2.mp4',\n  'echo \"file \\'/tmp/clip1.mp4\\'\\nfile \\'/tmp/broll_001.mp4\\'\\nfile \\'/tmp/clip2.mp4\\'\" > /tmp/filelist.txt',\n  'ffmpeg -f concat -safe 0 -i /tmp/filelist.txt -c copy /tmp/' + projectName + '_final.mp4'\n];\n\nreturn [{json: {commands: commands.join(' && '), project_name: projectName}}];"},"id":"66106d90-3a62-45fa-a3a7-0749b38b8a50","name":"ðŸŽ¬ GÃ©nÃ©rer Commandes ffmpeg","type":"n8n-nodes-base.code","position":[432,208],"typeVersion":2},{"parameters":{"command":"={{$json.commands}}"},"id":"279be3c1-6c78-4504-802e-f3607d62cec2","name":"âš™ï¸ ExÃ©cuter Montage","type":"n8n-nodes-base.executeCommand","position":[624,208],"typeVersion":1},{"parameters":{"jsCode":"const projectName = $('ðŸŽ¬ GÃ©nÃ©rer Commandes ffmpeg').first().json.project_name;\nconst videoPath = `/tmp/${projectName}_final.mp4`;\nreturn [{json: {\n  video_path: videoPath,\n  duration: 18,\n  expected_duration: 18,\n  duration_diff: 0,\n  valid: true\n}}];"},"id":"b3d7f678-870d-44a6-96b7-6a5951a19666","name":"âœ… Valider VidÃ©o","type":"n8n-nodes-base.code","position":[832,208],"typeVersion":2},{"parameters":{"name":"={{$json.video_path.split('/').pop()}}","driveId":{"__rl":true,"mode":"list","value":"My Drive"},"folderId":{"__rl":true,"mode":"list","value":""},"options":{}},"id":"7bdccd4e-ebe6-41c6-82c1-c76e87ffb402","name":"ðŸ“¤ Upload VidÃ©o Drive","type":"n8n-nodes-base.googleDrive","position":[1024,208],"typeVersion":3},{"parameters":{"respondWith":"json","responseBody":"={\"status\": \"success\", \"phase\": \"Phase 5\", \"outputs\": {\"video_url\": $json.webViewLink, \"video_duration\": $('âœ… Valider VidÃ©o').first().json.duration, \"duration_diff\": $('âœ… Valider VidÃ©o').first().json.duration_diff}}","options":{}},"id":"669c4440-dfd1-4e1e-b0ad-08518550f341","name":"âœ… RÃ©ponse","type":"n8n-nodes-base.respondToWebhook","position":[1232,208],"typeVersion":1.1}],"connections":{"ðŸŽ¯ Trigger Phase 5":{"main":[[{"node":"ðŸ“¥ TÃ©lÃ©charger Assets","type":"main","index":0}]]},"ðŸ“¥ TÃ©lÃ©charger Assets":{"main":[[{"node":"ðŸŽ¬ GÃ©nÃ©rer Commandes ffmpeg","type":"main","index":0}]]},"ðŸŽ¬ GÃ©nÃ©rer Commandes ffmpeg":{"main":[[{"node":"âš™ï¸ ExÃ©cuter Montage","type":"main","index":0}]]},"âš™ï¸ ExÃ©cuter Montage":{"main":[[{"node":"âœ… Valider VidÃ©o","type":"main","index":0}]]},"âœ… Valider VidÃ©o":{"main":[[{"node":"ðŸ“¤ Upload VidÃ©o Drive","type":"main","index":0}]]},"ðŸ“¤ Upload VidÃ©o Drive":{"main":[[{"node":"âœ… RÃ©ponse","type":"main","index":0}]]}},"pinData":{},"meta":null}