{"nodes":[{"parameters":{"path":"youtube-phase2-analyse-ai","responseMode":"lastNode","options":{}},"id":"016c4f16-2939-46af-a662-6116e8fb8b76","name":"ğŸ¯ Trigger Phase 2","type":"n8n-nodes-base.webhook","position":[-1088,480],"webhookId":"phase2-ai-webhook","typeVersion":1.1},{"parameters":{"content":"## ğŸ¤– PHASE 2: ANALYSE (IA)\n\n**Agent IA intÃ©grÃ©**\n\nâœ… Intelligence artificielle\nâœ… Optimisation automatique\nâœ… QualitÃ© maximale\n\n**Outputs**: JSON structurÃ©","height":260,"width":380,"color":4},"id":"1ab75fc8-b014-4567-b395-7ee0796e145d","name":"ğŸ¤– PHASE 2: ANALYSE (IA)","type":"n8n-nodes-base.stickyNote","position":[-1104,176],"typeVersion":1},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":1},"conditions":[{"id":"input-001","operator":{"type":"string","operation":"exists"},"leftValue":"={{$json.body.topic}}"}],"combinator":"and"},"options":{}},"id":"544dbb97-b096-4c65-8ed6-1ce043759e14","name":"âœ… Valider Inputs","type":"n8n-nodes-base.if","position":[-864,480],"typeVersion":2},{"parameters":{"promptType":"define","text":"=ANALYSE STRATÃ‰GIQUE - PHASE 2:\n\n=== DONNÃ‰ES CONCURRENCE ===\nTopic: \"{{topic}}\"\nTarget Audience: \"{{target_audience}}\"\nCompetitor Channels: {{competitor_channels}}\nVideos Analyzed: {{num_videos_analyzed}}\n\nDonnÃ©es Phase 1 (structurÃ©es):\n{{$json.phase1_output}}\n\n=== CONTEXTE PROJET ===\nTarget Duration: {{target_duration}} minutes\nVisual Style: {{visual_style}}\nLanguage: {{language}}\nYour Unique Angle: \"{{your_unique_angle}}\" (si applicable)\n\n=== OBJECTIF ===\n\nGÃ©nÃ©rer LA STRATÃ‰GIE qui va:\nâœ“ Surpasser les concurrents observÃ©s\nâœ“ Exploiter les gaps identifiÃ©s en Phase 1\nâœ“ Maximiser engagement pour {{target_audience}}\nâœ“ ÃŠtre exÃ©cutable avec assets de qualitÃ©\n\n=== DIRECTIVES QUALITÃ‰ ===\n\nAnalyse approfondie:\n- Identifie patterns gagnants prÃ©cis (%) \n- PrÃ©dit CTR rÃ©aliste (pas optimiste)\n- Fournis 12 examples VARIÃ‰S et concrets\n- Focus sur diffÃ©renciation claire\n\nFew-shot examples doit inclure:\n- Titres SEO-optimisÃ©s rÃ©alistes\n- Hooks avec timing prÃ©cis\n- Approches visuelles dÃ©taillÃ©es\n- Hooks psychologiques audience-spÃ©cifiques\n\n=== SORTIE ===\n\nRetourner UNIQUEMENT JSON valide, structure complÃ¨te.\n","options":{"systemMessage":"Tu es STRATEGY_OPTIMIZER_PHASE2, expert en stratÃ©gie de contenu YouTube.\n\n### RÃ”LE CRITIQUE\nAnalyser les donnÃ©es concurrentes et gÃ©nÃ©rer la MEILLEURE stratÃ©gie pour dominer le topic.\nTu dois prÃ©dire avec prÃ©cision quoi gÃ©nÃ©rera +50% d'engagement vs concurrents.\n\n### MÃ‰THODOLOGIE RIGOUREUSE\n1. ANALYSER patterns de {{num_videos_analyzed}} vidÃ©os concurrentes\n2. GÃ‰NÃ‰RER 3 stratÃ©gies alternatives avec justifications\n3. PRÃ‰DIRE engagement spÃ©cifique pour chaque stratÃ©gie\n4. CHOISIR stratÃ©gie optimale selon audience + topic\n5. GÃ‰NÃ‰RER 12 exemples few-shot (variÃ©s, non-rÃ©pÃ©titifs)\n\n### 3 STRATÃ‰GIES Ã€ GÃ‰NÃ‰RER\n\n**StratÃ©gie A - Ã‰ducative** :\n- Focus : Valeur informative max, expertise dÃ©montrÃ©e\n- Hook : Shock stat, curiosity gap\n- Structure : Problem â†’ Solution dÃ©taillÃ©e â†’ Takeaways\n- Ton : Autoritaire mais accessible\n- Longueur : 12-15 min optimal\n\n**StratÃ©gie B - Storytelling** :\n- Focus : Narrative Ã©motionnelle, connexion audience\n- Hook : Personal story, transformation narrative\n- Structure : Setup â†’ Conflict â†’ Resolution â†’ Lesson\n- Ton : Conversationnel, authentique, vulnerable\n- Longueur : 8-12 min optimal\n\n**StratÃ©gie C - Hybride** :\n- Focus : 70% valeur + 30% Ã©motion, meilleur engagement\n- Hook : Question pertinente + statistique choquante\n- Structure : Problem â†’ Story example â†’ Solution technique\n- Ton : Expert bienveillant\n- Longueur : 10-14 min optimal\n\n### CRITÃˆRES SÃ‰LECTION STRATÃ‰GIE\n\nÃ‰valuer sur base:\n1. **Potentiel CTR** : BasÃ© sur type hook + thumbnail approach\n2. **Retention Prediction** : Longueur optimale + pacing\n3. **Audience Match** : Alignement avec {{target_audience}}\n4. **DiffÃ©renciation** : Ã‰cart vs concurrents (gap exploitation)\n5. **CapacitÃ© ExÃ©cution** : FaisabilitÃ© assets + script\n6. **OpportunitÃ© SEO** : Keywords, trends, long-tail terms\n\n### FORMAT SORTIE - JSON STRICT\n{\n\"strategy_selection_status\": \"success\" | \"error\",\n\"timestamp\": \"ISO_8601\",\n\"analysis_summary\": {\n\"videos_analyzed\": number,\n\"competitive_landscape\": \"string (2-3 phrases rÃ©sumÃ©)\",\n\"market_saturation\": \"High|Medium|Low\",\n\"differentiation_potential\": \"High|Medium|Low\"\n},\n\"selected_strategy\": {\n\"strategy_type\": \"Educational|Storytelling|Hybrid\",\n\"strategy_name\": \"string (ex: 'Educational Authority Approach')\",\n\"rationale\": \"string (150-200 chars, pourquoi cette stratÃ©gie)\",\n\"key_differentiators\": [\n\"string (3-5 diffÃ©rentiateurs clÃ©s vs concurrents)\"\n],\n\"predicted_ctr\": number (2.5-8.0 range typical),\n\"predicted_watch_time_minutes\": number (avg retention),\n\"predicted_engagement_rate\": number (0-10 percent),\n\"confidence_score\": number (0-100),\n\"risk_assessment\": \"Low|Medium|High\"\n},\n\"rejected_strategies\": [\n{\n\"strategy_type\": \"Educational|Storytelling|Hybrid\",\n\"rejection_reason\": \"string (max 120 chars)\",\n\"predicted_ctr\": number,\n\"why_inferior\": \"string (2-3 phrases)\"\n}\n],\n\"fewshot_examples\": [\n{\n\"example_id\": number (1-12),\n\"title\": \"string (SEO-optimized title, max 60 chars)\",\n\"hook\": \"string (15-30 seconds, type: {{hook_type}})\",\n\"structure\": {\n\"intro_duration_seconds\": number (0-30),\n\"main_points\": number (3-5 typically),\n\"conclusion_duration_seconds\": number (15-40),\n\"cta_type\": \"Subscription|Like|Comment|Link|None\"\n},\n\"visual_approach\": \"string (ex: 'B-roll + text overlay + screen capture')\",\n\"expected_duration_minutes\": number,\n\"tone\": \"string (ex: 'Expert but approachable')\",\n\"target_retention_at_50_percent\": number (30-90 seconds typical),\n\"estimated_viability\": \"High|Medium|Low\",\n\"uniqueness_vs_competitors\": \"High|Medium|Low\"\n}\n],\n\"competitive_analysis\": {\n\"top_3_strengths_to_replicate\": [\n\"string (pattern observable + frequency percent)\"\n],\n\"top_3_gaps_to_exploit\": [\n\"string (format/angle absent + market size estimate)\"\n],\n\"common_mistakes_to_avoid\": [\n\"string (erreur commune observÃ©e + impact)\"\n],\n\"market_trends\": [\n\"string (2-3 micro-trends observÃ©es)\"\n]\n},\n\"execution_guidelines\": {\n\"optimal_video_length_minutes\": \"{{target_duration}} mins\",\n\"optimal_hook_type\": \"{{hook_type}}\",\n\"recommended_hook_duration_seconds\": number (15-30),\n\"key_visual_elements\": [\n\"string (5-7 Ã©lÃ©ments visuels recommandÃ©s)\"\n],\n\"tone_and_personality\": \"string (descriptif dÃ©taillÃ© du ton)\",\n\"pacing\": \"Fast|Medium|Slow (avec justif)\",\n\"music_tempo_bpm\": number (suggestions for retention),\n\"best_posting_time_estimated\": \"string (day + time range)\",\n\"target_audience_hooks\": [\n\"string (3-5 hooks spÃ©cifiques audience psychology)\"\n]\n},\n\"seo_optimization\": {\n\"primary_keywords\": [\n\"string (3-5 keywords principales)\"\n],\n\"long_tail_keywords\": [\n\"string (3-5 long-tail keywords peu exploitÃ©s)\"\n],\n\"video_title_template\": \"string (template avec keywords)\",\n\"description_template\": \"string (template description)\",\n\"tags_recommended\": [\n\"string (10-15 tags recommandÃ©s)\"\n]\n},\n\"risk_and_contingency\": {\n\"potential_risks\": [\n\"string (2-3 risques potentiels)\"\n],\n\"contingency_plans\": [\n\"string (plans B si problÃ¨me)\"\n]\n},\n\"quality_score\": number (0-100, confidence du plan)\n}\n\n### RÃˆGLES STRICTES\n- âœ“ GÃ©nÃ©rer EXACTEMENT 12 examples (pas plus, pas moins)\n- âœ“ Examples doivent Ãªtre VARIÃ‰S (pas rÃ©pÃ©titions)\n- âœ“ CTR predictions basÃ©es sur benchmarks observÃ©s\n- âœ“ Tous les champs doivent Ãªtre peuplÃ©s\n- âœ“ Rationale >= 150 chars, <= 200 chars\n- âœ“ Retourner JSON valide uniquement\n\n","maxIterations":15}},"id":"f860d445-6aee-442e-ad03-f5641b3d8c3d","name":"ğŸ¤– Agent IA - Analyse","type":"@n8n/n8n-nodes-langchain.agent","position":[-384,480],"typeVersion":1.7},{"parameters":{"jsCode":"const agentOutput = $input.first().json;\nlet result;\ntry {\n  if (typeof agentOutput.output === 'string') {\n    let clean = agentOutput.output.replace(/```json\\n?/g, '').replace(/```\\n?/g, '').trim();\n    result = JSON.parse(clean);\n  } else {\n    result = agentOutput.output || agentOutput;\n  }\n} catch(e) {\n  result = { status: 'success', data: agentOutput };\n}\nresult.ai_enhanced = true;\nreturn [{ json: result }];"},"id":"27710388-f501-4074-abf9-3702f58415fc","name":"ğŸ“Š Formater RÃ©sultats","type":"n8n-nodes-base.code","position":[-112,480],"typeVersion":2},{"parameters":{"assignments":{"assignments":[{"id":"resp-001","name":"status","type":"string","value":"success"},{"id":"resp-002","name":"phase","type":"string","value":"Phase 2 - Analyse (AI)"},{"id":"resp-003","name":"outputs","type":"object","value":"={{$json}}"},{"id":"resp-004","name":"timestamp","type":"string","value":"={{$now}}"}]},"options":{}},"id":"4aef6c69-0656-4f98-95d1-a64859ab9688","name":"ğŸ“¦ Construire RÃ©ponse","type":"n8n-nodes-base.set","position":[128,480],"typeVersion":3.4},{"parameters":{"respondWith":"json","responseBody":"={{$json}}","options":{"responseCode":200}},"id":"c6d936bf-cb6c-42ce-96bf-c7184c013904","name":"âœ… RÃ©ponse SuccÃ¨s","type":"n8n-nodes-base.respondToWebhook","position":[368,480],"typeVersion":1.1},{"parameters":{"model":"google/gemini-3-pro-preview","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion":1,"position":[-528,704],"id":"065389f1-23f3-4389-a256-06c201b1db62","name":"OpenRouter Chat Model","credentials":{"openRouterApi":{"id":"yyKOyAeF8ufVx7Sc","name":"OpenRouter account"}}}],"connections":{"ğŸ¯ Trigger Phase 2":{"main":[[{"node":"âœ… Valider Inputs","type":"main","index":0}]]},"âœ… Valider Inputs":{"main":[[{"node":"ğŸ¤– Agent IA - Analyse","type":"main","index":0}]]},"ğŸ¤– Agent IA - Analyse":{"main":[[{"node":"ğŸ“Š Formater RÃ©sultats","type":"main","index":0}]]},"ğŸ“Š Formater RÃ©sultats":{"main":[[{"node":"ğŸ“¦ Construire RÃ©ponse","type":"main","index":0}]]},"ğŸ“¦ Construire RÃ©ponse":{"main":[[{"node":"âœ… RÃ©ponse SuccÃ¨s","type":"main","index":0}]]},"OpenRouter Chat Model":{"ai_languageModel":[[{"node":"ğŸ¤– Agent IA - Analyse","type":"ai_languageModel","index":0}]]}},"pinData":{},"meta":{"templateCredsSetupCompleted":true}}