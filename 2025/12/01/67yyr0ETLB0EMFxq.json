{"nodes":[{"parameters":{},"id":"b030f728-5619-4e4c-9457-303fa14cc619","name":"D√©clencheur Manuel","type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[-112,256]},{"parameters":{"assignments":{"assignments":[{"id":"youtube-url-field","name":"youtubeUrl","type":"string","value":"https://www.youtube.com/watch?v=EXAMPLE_VIDEO_ID"}]},"options":{}},"id":"539dd809-2951-43e0-98d5-d3f8b2cc59e3","name":"D√©finir URL YouTube","type":"n8n-nodes-base.set","typeVersion":3.4,"position":[112,256]},{"parameters":{"jsCode":"const extractYoutubeId = (url) => {\n  const pattern = /(?:youtube\\.com\\/(?:[^\\/]+\\/.+\\/|(?:v|e(?:mbed)?)\\/|.*[?&]v=)|youtu\\.be\\/)([^\"&?\\/\\s]{11})/;\n  const match = url.match(pattern);\n  return match ? match[1] : null;\n};\n\nconst youtubeUrl = $input.first().json.youtubeUrl;\nconst videoId = extractYoutubeId(youtubeUrl);\n\nreturn [{ json: { videoId: videoId, youtubeUrl: youtubeUrl } }];"},"id":"d729d76a-6268-408b-b0c6-ebd35c9e13ca","name":"Extraire ID Vid√©o YouTube","type":"n8n-nodes-base.code","typeVersion":2,"position":[336,256]},{"parameters":{"url":"=https://www.googleapis.com/youtube/v3/videos","sendQuery":true,"queryParameters":{"parameters":[{"name":"part","value":"snippet"},{"name":"id","value":"={{ $json.videoId }}"},{"name":"key","value":"VOTRE_CLE_API_YOUTUBE"}]},"options":{}},"id":"a89091d4-561f-4c86-8c2d-c0d24e07e49d","name":"R√©cup√©rer M√©tadonn√©es Vid√©o","type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[560,256]},{"parameters":{"assignments":{"assignments":[{"id":"title-field","name":"videoTitle","type":"string","value":"={{ $json.items[0].snippet.title }}"},{"id":"video-id-keep","name":"videoId","type":"string","value":"={{ $('Extraire ID Vid√©o YouTube').item.json.videoId }}"},{"id":"processing-date","name":"processingDate","type":"string","value":"={{ $now.format('yyyy-MM-dd HH:mm:ss') }}"}]},"options":{}},"id":"6f6f4fa4-e498-4512-985c-1b2d2ca52167","name":"Extraire Titre","type":"n8n-nodes-base.set","typeVersion":3.4,"position":[784,256]},{"parameters":{},"id":"a1096b12-4b50-4220-b994-e13e2e0ab757","name":"R√©cup√©rer Transcription YouTube","type":"n8n-nodes-youtube-transcription.youtubeTranscripter","typeVersion":1,"position":[-112,480]},{"parameters":{"fieldsToSummarize":{"values":[{"field":"text"}]},"options":{}},"id":"4af613b3-307d-445b-99e2-27dc09bb4df8","name":"Concat√©ner Transcription","type":"n8n-nodes-base.summarize","typeVersion":1,"position":[-112,808]},{"parameters":{"promptType":"define","messages":{"messageValues":[{"message":"=Titre de la vid√©o : {{ $('Extraire Titre').item.json.videoTitle }}\n\nTranscription compl√®te :\n{{ $json.concatenatedText }}\n\n---\n\nTu es un ghostwriter de haut niveau sp√©cialis√© dans la cr√©ation de contenu vid√©o captivant. Ta mission est de r√©√©crire cette transcription en un script professionnel et engageant qui :\n\n1. **HOOK PUISSANT** : Commence par un hook accrocheur dans les 5 premi√®res secondes qui capte imm√©diatement l'attention (question provocante, statistique surprenante, ou affirmation audacieuse)\n\n2. **STRUCTURE CLAIRE** :\n   - Introduction captivante (10-15 secondes)\n   - D√©veloppement des points cl√©s avec transitions fluides\n   - Conclusion m√©morable avec call-to-action\n\n3. **STYLE D'√âCRITURE** :\n   - Langage conversationnel et authentique\n   - Phrases courtes et impactantes\n   - Storytelling engageant\n   - Rythme dynamique\n\n4. **OPTIMISATION** :\n   - Supprime les r√©p√©titions et h√©sitations\n   - Renforce les messages cl√©s\n   - Ajoute des moments √©motionnels strat√©giques\n\nProduis un script complet, pr√™t √† √™tre utilis√©, optimis√© pour une vid√©o virale."}]}},"id":"1ff7caf2-5a38-4bb2-b4a7-d33430c55ade","name":"R√©√©crire comme Ghostwriter","type":"@n8n/n8n-nodes-langchain.chainLlm","typeVersion":1.5,"position":[112,808]},{"parameters":{"model":{"rl":true,"mode":"list","value":"gpt-4o","cachedResultName":"gpt-4o"},"options":{"maxTokens":3000,"temperature":0.8}},"id":"7ed43602-7781-4c37-aca4-930218e712c1","name":"Mod√®le OpenAI GPT-4o","type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[184,1032]},{"parameters":{"jsCode":"const rewrittenScript = $input.first().json.text;\nconst videoTitle = $('Extraire Titre').item.json.videoTitle;\nconst videoId = $('Extraire Titre').item.json.videoId;\nconst processingDate = $('Extraire Titre').item.json.processingDate;\n\n// Fonction pour d√©couper le script en segments logiques\nconst splitIntoSegments = (text) => {\n  const sentences = text.match(/[^.!?]+[.!?]+/g) || [];\n  const segments = [];\n  let currentSegment = '';\n  let segmentNumber = 1;\n\n  sentences.forEach((sentence, index) => {\n    if ((currentSegment + sentence).length < 250) {\n      currentSegment += sentence;\n    } else {\n      if (currentSegment.trim()) {\n        segments.push({\n          segmentNumber: segmentNumber++,\n          text: currentSegment.trim(),\n          characterCount: currentSegment.trim().length,\n          type: segmentNumber === 2 ? 'hook' : (index > sentences.length - 3 ? 'conclusion' : 'body')\n        });\n      }\n      currentSegment = sentence;\n    }\n  });\n\n  if (currentSegment.trim()) {\n    segments.push({\n      segmentNumber: segmentNumber,\n      text: currentSegment.trim(),\n      characterCount: currentSegment.trim().length,\n      type: 'conclusion'\n    });\n  }\n\n  return segments;\n};\n\nconst segments = splitIntoSegments(rewrittenScript);\n\nreturn segments.map(segment => ({\n  json: {\n    videoId: videoId,\n    videoTitle: videoTitle,\n    processingDate: processingDate,\n    segmentNumber: segment.segmentNumber,\n    segmentType: segment.type,\n    scriptText: segment.text,\n    characterCount: segment.characterCount,\n    brollKeywords: segment.text.substring(0, 80).replace(/[^a-zA-Z0-9 ]/g, '').trim(),\n    estimatedDuration: Math.ceil(segment.characterCount / 15),\n    status: 'pending',\n    imageGenerated: false,\n    brollFound: false\n  }\n}));"},"id":"42073c33-da28-472e-9f0e-42de58bf9d4e","name":"D√©couper Script en Segments","type":"n8n-nodes-base.code","typeVersion":2,"position":[464,808]},{"parameters":{"dataTableId":{"mode":"list","value":"VIDEO_SEGMENTS_TABLE_ID","cachedResultName":"VideoSegmentsTable"},"columns":{"mappingMode":"defineBelow","value":{"video_id":"={{ $json.videoId }}","video_title":"={{ $json.videoTitle }}","processing_date":"={{ $json.processingDate }}","segment_number":"={{ $json.segmentNumber }}","segment_type":"={{ $json.segmentType }}","script_text":"={{ $json.scriptText }}","character_count":"={{ $json.characterCount }}","broll_keywords":"={{ $json.brollKeywords }}","estimated_duration":"={{ $json.estimatedDuration }}","status":"={{ $json.status }}","image_generated":"={{ $json.imageGenerated }}","broll_found":"={{ $json.brollFound }}"}}},"id":"21bc2d2f-0025-4714-a306-237ecc9f0ee2","name":"Ins√©rer dans Data Table","type":"n8n-nodes-base.dataTable","typeVersion":1,"position":[688,808]},{"parameters":{"operation":"get","dataTableId":{"mode":"list","value":"VIDEO_SEGMENTS_TABLE_ID","cachedResultName":"VideoSegmentsTable"},"filters":{"conditions":[{"condition":"equals"},{"condition":"equals"}]}},"id":"9ad0729e-757f-4b21-b85b-aad0c1309b60","name":"R√©cup√©rer Segments depuis Data Table","type":"n8n-nodes-base.dataTable","typeVersion":1,"position":[912,808]},{"parameters":{"assignments":{"assignments":[{"id":"row-id","name":"dataTableRowId","type":"number","value":"={{ $json.id }}"},{"id":"segment-data","name":"segmentData","type":"object","value":"={{ { videoId: $json.video_id, videoTitle: $json.video_title, segmentNumber: $json.segment_number, segmentType: $json.segment_type, scriptText: $json.script_text, brollKeywords: $json.broll_keywords, estimatedDuration: $json.estimated_duration } }}"},{"id":"ready-flag","name":"readyForProcessing","type":"boolean","value":true}]},"options":{}},"id":"0c576eff-2653-449b-b3dc-b68ca0995d93","name":"Formater pour Workflow suivant","type":"n8n-nodes-base.set","typeVersion":3.4,"position":[1136,808]},{"parameters":{"content":"## üìã Configuration Requise\n\n**1. Cr√©er la Data Table :**\n- Nom : VideoSegmentsTable\n- Colonnes :\n  ‚Ä¢ video_id (string)\n  ‚Ä¢ video_title (string)\n  ‚Ä¢ processing_date (string)\n  ‚Ä¢ segment_number (number)\n  ‚Ä¢ segment_type (string)\n  ‚Ä¢ script_text (string)\n  ‚Ä¢ character_count (number)\n  ‚Ä¢ broll_keywords (string)\n  ‚Ä¢ estimated_duration (number)\n  ‚Ä¢ status (string)\n  ‚Ä¢ image_generated (boolean)\n  ‚Ä¢ broll_found (boolean)\n\n**2. APIs :**\n- Cl√© API YouTube\n- Credentials OpenAI\n\n**3. Packages :**\n- n8n-nodes-youtube-transcription","height":420,"width":480,"color":4},"id":"587bd615-a478-46b6-bb16-d036181825ba","name":"Note - Configuration","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-192,-256]},{"parameters":{"content":"## üé¨ Extraction Vid√©o\n\n- Extraction ID vid√©o\n- R√©cup√©ration m√©tadonn√©es\n- T√©l√©chargement transcription\n- Concat√©nation du texte","height":140,"width":760,"color":5},"id":"9fa99da8-d8f4-4b23-b540-6e0621f09b43","name":"Note - Extraction","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[416,-128]},{"parameters":{"content":"## ‚úçÔ∏è R√©√©criture Ghostwriter\n\n**GPT-4o** transforme en script professionnel :\n- Hook captivant (5 secondes)\n- Structure narrative optimis√©e\n- Style conversationnel engageant","width":460,"color":6},"id":"01cfa2dc-9787-462c-8686-be7751cfd4fd","name":"Note - Ghostwriting","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1280,-96]},{"parameters":{"content":"## üíæ Stockage Data Tables\n\n**Avantages :**\n- ‚úÖ 100x plus rapide que Google Sheets\n- ‚úÖ Stockage natif dans n8n\n- ‚úÖ Pas de credentials externes\n- ‚úÖ Jusqu'√† 50MB (500k+ lignes)\n- ‚úÖ Gestion de statut des segments\n- ‚úÖ R√©utilisable par autres workflows\n\n**Chaque segment stock√© avec :**\n- M√©tadonn√©es vid√©o\n- Type de segment (hook/body/conclusion)\n- Keywords pour B-roll\n- Statut de traitement\n- Flags g√©n√©ration image/B-roll","height":320,"width":940,"color":7},"id":"edf085f7-84a8-467b-87f4-86a3aa469d41","name":"Note - Data Tables","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1824,-128]},{"parameters":{"content":"## üîó Workflow Suivant - G√©n√©ration Images/B-roll\n\n**Ce workflow pr√©pare les donn√©es. Cr√©ez un second workflow qui :**\n\n1. **Lit la Data Table** avec le n≈ìud Data Table (Get)\n2. **Filtre** les segments `status = 'pending'`\n3. **G√©n√®re des images** avec DALL-E ou Midjourney bas√© sur `broll_keywords`\n4. **Recherche B-roll** via Pexels/Unsplash API\n5. **Met √† jour le statut** avec Data Table (Update)\n6. **Marque** `image_generated = true` et `status = 'completed'`\n\n**D√©clencheur sugg√©r√© :** Schedule (toutes les 5 minutes) ou Webhook","height":220,"width":2700,"color":3},"id":"ea03afc4-963c-4773-92f5-f60c14c73670","name":"Note - Int√©gration Workflow","type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[128,464]}],"connections":{"D√©clencheur Manuel":{"main":[[{"node":"D√©finir URL YouTube","type":"main","index":0}]]},"D√©finir URL YouTube":{"main":[[{"node":"Extraire ID Vid√©o YouTube","type":"main","index":0}]]},"Extraire ID Vid√©o YouTube":{"main":[[{"node":"R√©cup√©rer M√©tadonn√©es Vid√©o","type":"main","index":0}]]},"R√©cup√©rer M√©tadonn√©es Vid√©o":{"main":[[{"node":"Extraire Titre","type":"main","index":0}]]},"Concat√©ner Transcription":{"main":[[{"node":"R√©√©crire comme Ghostwriter","type":"main","index":0}]]},"R√©√©crire comme Ghostwriter":{"main":[[{"node":"D√©couper Script en Segments","type":"main","index":0}]]},"Mod√®le OpenAI GPT-4o":{"ai_languageModel":[[{"node":"R√©√©crire comme Ghostwriter","type":"ai_languageModel","index":0}]]},"D√©couper Script en Segments":{"main":[[{"node":"Ins√©rer dans Data Table","type":"main","index":0}]]},"Ins√©rer dans Data Table":{"main":[[{"node":"R√©cup√©rer Segments depuis Data Table","type":"main","index":0}]]},"R√©cup√©rer Segments depuis Data Table":{"main":[[{"node":"Formater pour Workflow suivant","type":"main","index":0}]]}},"pinData":{},"meta":null}